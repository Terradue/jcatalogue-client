package com.terradue.jcatalogue.client;

import java.util.Iterator;

import lombok.Data;

@Data
final class LazyLoadDataSetIterator
    implements Iterator<DataSet>
{

    private final CatalogueClient catalogueClient;

    private final Iterator<String> dataSetUrlsIterator;

    @Override
    public boolean hasNext()
    {
        return dataSetUrlsIterator.hasNext();
    }

    @Override
    public DataSet next()
    {
        String nextUrl = dataSetUrlsIterator.next();
        return catalogueClient.getDataSet( nextUrl );
    }

    @Override
    public void remove()
    {
        // not needed, won't be invoked ATM
    }

}
